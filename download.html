<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <title>Ваш гайд</title>
</head>

<body>
    <h1>Спасибо за оплату!</h1>
    <p id="status">Ищем ваш гайд...</p>

    <script>
        async function getGuideLink(orderId) {
            const response = await fetch("https://hook.make.com/xxx", { // <-- замените на свой Webhook
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ order_id: orderId })
            });

            const data = await response.json();
            return data.guide_link;
        }

        (async () => {
            const params = new URLSearchParams(window.location.search);
            const orderId = params.get("order_id");

            if (!orderId) {
                document.getElementById("status").innerText = "Ошибка: номер заказа не найден.";
                return;
            }

            try {
                const link = await getGuideLink(orderId);
                if (link) {
                    // Можно сразу редиректить:
                    window.location.href = link;

                    // Или просто показать кнопку
                    // document.getElementById("status").innerHTML = `<a href="${link}" target="_blank">Скачать гайд</a>`;
                } else {
                    document.getElementById("status").innerText = "Гайд не найден. Свяжитесь с поддержкой.";
                }
            } catch (error) {
                console.error(error);
                document.getElementById("status").innerText = "Произошла ошибка.";
            }
        })();
    </script>
</body>

</html>